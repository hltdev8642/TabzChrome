<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Display Test - MCP Test Pages</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .selector-hint { font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; }
  </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
  <!-- Navigation -->
  <nav id="breadcrumb" class="bg-gray-800 border-b border-gray-700 px-6 py-3">
    <a href="index.html" id="nav-home" class="text-purple-400 hover:text-purple-300">â† MCP Test Hub</a>
    <span class="text-gray-500 mx-2">/</span>
    <span class="text-gray-300">Data Display</span>
  </nav>

  <!-- Page Header -->
  <header id="page-header" class="bg-gray-800 border-b border-gray-700 px-6 py-4">
    <h1 id="page-title" class="text-2xl font-bold text-purple-400">ğŸ“Š Data Display Test Page</h1>
    <p id="page-description" class="text-gray-400 mt-1">Test tabz_get_element, tabz_get_dom_tree with tables, lists, and cards</p>
  </header>

  <main class="container mx-auto px-6 py-8 max-w-6xl">

    <!-- Data Table Section -->
    <section id="table-section" class="mb-12 bg-gray-800 rounded-lg p-6 border border-gray-700">
      <h2 class="text-xl font-semibold text-blue-400 mb-4">Sortable Data Table</h2>

      <div class="overflow-x-auto">
        <table id="data-table" data-testid="data-table" class="w-full text-sm">
          <thead>
            <tr class="bg-gray-700">
              <th
                id="sort-by-id"
                data-testid="sort-by-id"
                data-sort="id"
                onclick="sortTable('id')"
                class="px-4 py-3 text-left text-gray-300 font-semibold cursor-pointer hover:bg-gray-600"
              >
                ID â†•
              </th>
              <th
                id="sort-by-name"
                data-testid="sort-by-name"
                data-sort="name"
                onclick="sortTable('name')"
                class="px-4 py-3 text-left text-gray-300 font-semibold cursor-pointer hover:bg-gray-600"
              >
                Name â†•
              </th>
              <th
                id="sort-by-email"
                data-testid="sort-by-email"
                data-sort="email"
                onclick="sortTable('email')"
                class="px-4 py-3 text-left text-gray-300 font-semibold cursor-pointer hover:bg-gray-600"
              >
                Email â†•
              </th>
              <th
                id="sort-by-status"
                data-testid="sort-by-status"
                data-sort="status"
                onclick="sortTable('status')"
                class="px-4 py-3 text-left text-gray-300 font-semibold cursor-pointer hover:bg-gray-600"
              >
                Status â†•
              </th>
              <th class="px-4 py-3 text-left text-gray-300 font-semibold">Actions</th>
            </tr>
          </thead>
          <tbody id="table-body">
            <!-- Rows generated by JS -->
          </tbody>
        </table>
      </div>

      <p id="table-sort-info" data-testid="table-sort-info" class="mt-4 text-sm text-gray-500">
        Sorted by: <span class="text-purple-400">id</span> (ascending)
      </p>
    </section>

    <!-- List Section -->
    <section id="list-section" class="mb-12 bg-gray-800 rounded-lg p-6 border border-gray-700">
      <h2 class="text-xl font-semibold text-blue-400 mb-4">Interactive List</h2>

      <ul id="item-list" data-testid="item-list" class="space-y-2">
        <li
          id="list-item-1"
          data-testid="list-item-1"
          data-id="1"
          class="list-item flex items-center justify-between bg-gray-900 rounded p-4 hover:bg-gray-700 cursor-pointer"
          onclick="selectListItem(1)"
        >
          <div class="flex items-center gap-3">
            <span class="text-2xl">ğŸ“</span>
            <div>
              <p class="text-white font-medium">Documents</p>
              <p class="text-sm text-gray-400">24 files, 156 MB</p>
            </div>
          </div>
          <button
            id="list-item-1-action"
            data-testid="list-item-1-action"
            onclick="event.stopPropagation(); itemAction(1, 'open')"
            class="text-purple-400 hover:text-purple-300"
          >
            Open â†’
          </button>
        </li>

        <li
          id="list-item-2"
          data-testid="list-item-2"
          data-id="2"
          class="list-item flex items-center justify-between bg-gray-900 rounded p-4 hover:bg-gray-700 cursor-pointer"
          onclick="selectListItem(2)"
        >
          <div class="flex items-center gap-3">
            <span class="text-2xl">ğŸ–¼ï¸</span>
            <div>
              <p class="text-white font-medium">Images</p>
              <p class="text-sm text-gray-400">89 files, 2.4 GB</p>
            </div>
          </div>
          <button
            id="list-item-2-action"
            data-testid="list-item-2-action"
            onclick="event.stopPropagation(); itemAction(2, 'open')"
            class="text-purple-400 hover:text-purple-300"
          >
            Open â†’
          </button>
        </li>

        <li
          id="list-item-3"
          data-testid="list-item-3"
          data-id="3"
          class="list-item flex items-center justify-between bg-gray-900 rounded p-4 hover:bg-gray-700 cursor-pointer"
          onclick="selectListItem(3)"
        >
          <div class="flex items-center gap-3">
            <span class="text-2xl">ğŸµ</span>
            <div>
              <p class="text-white font-medium">Music</p>
              <p class="text-sm text-gray-400">156 files, 4.8 GB</p>
            </div>
          </div>
          <button
            id="list-item-3-action"
            data-testid="list-item-3-action"
            onclick="event.stopPropagation(); itemAction(3, 'open')"
            class="text-purple-400 hover:text-purple-300"
          >
            Open â†’
          </button>
        </li>

        <li
          id="list-item-4"
          data-testid="list-item-4"
          data-id="4"
          class="list-item flex items-center justify-between bg-gray-900 rounded p-4 hover:bg-gray-700 cursor-pointer"
          onclick="selectListItem(4)"
        >
          <div class="flex items-center gap-3">
            <span class="text-2xl">ğŸ“¹</span>
            <div>
              <p class="text-white font-medium">Videos</p>
              <p class="text-sm text-gray-400">12 files, 18.2 GB</p>
            </div>
          </div>
          <button
            id="list-item-4-action"
            data-testid="list-item-4-action"
            onclick="event.stopPropagation(); itemAction(4, 'open')"
            class="text-purple-400 hover:text-purple-300"
          >
            Open â†’
          </button>
        </li>
      </ul>

      <p id="selected-list-item" data-testid="selected-list-item" class="mt-4 text-sm text-gray-500">
        Selected: <span class="text-purple-400">None</span>
      </p>
    </section>

    <!-- Cards Section -->
    <section id="cards-section" class="mb-12 bg-gray-800 rounded-lg p-6 border border-gray-700">
      <h2 class="text-xl font-semibold text-blue-400 mb-4">Product Cards</h2>

      <div id="card-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Card 1 -->
        <div
          id="card-1"
          data-testid="card-1"
          data-product-id="1"
          class="card bg-gray-900 rounded-lg overflow-hidden border border-gray-700 hover:border-purple-500 transition-colors"
        >
          <div class="h-32 bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center">
            <span class="text-4xl">ğŸ’»</span>
          </div>
          <div class="p-4">
            <h3 id="card-1-title" class="text-lg font-semibold text-white">MacBook Pro</h3>
            <p id="card-1-description" class="text-sm text-gray-400 mt-1">14" M3 Pro, 18GB RAM</p>
            <div class="flex justify-between items-center mt-4">
              <span id="card-1-price" class="text-xl font-bold text-green-400">$1,999</span>
              <button
                id="card-1-buy"
                data-testid="card-1-buy"
                data-action="buy"
                data-product="1"
                onclick="buyProduct(1)"
                class="bg-purple-600 hover:bg-purple-700 text-white text-sm py-1 px-3 rounded"
              >
                Add to Cart
              </button>
            </div>
          </div>
        </div>

        <!-- Card 2 -->
        <div
          id="card-2"
          data-testid="card-2"
          data-product-id="2"
          class="card bg-gray-900 rounded-lg overflow-hidden border border-gray-700 hover:border-purple-500 transition-colors"
        >
          <div class="h-32 bg-gradient-to-br from-green-600 to-teal-600 flex items-center justify-center">
            <span class="text-4xl">ğŸ“±</span>
          </div>
          <div class="p-4">
            <h3 id="card-2-title" class="text-lg font-semibold text-white">iPhone 15 Pro</h3>
            <p id="card-2-description" class="text-sm text-gray-400 mt-1">256GB, Titanium Blue</p>
            <div class="flex justify-between items-center mt-4">
              <span id="card-2-price" class="text-xl font-bold text-green-400">$999</span>
              <button
                id="card-2-buy"
                data-testid="card-2-buy"
                data-action="buy"
                data-product="2"
                onclick="buyProduct(2)"
                class="bg-purple-600 hover:bg-purple-700 text-white text-sm py-1 px-3 rounded"
              >
                Add to Cart
              </button>
            </div>
          </div>
        </div>

        <!-- Card 3 -->
        <div
          id="card-3"
          data-testid="card-3"
          data-product-id="3"
          class="card bg-gray-900 rounded-lg overflow-hidden border border-gray-700 hover:border-purple-500 transition-colors"
        >
          <div class="h-32 bg-gradient-to-br from-orange-600 to-red-600 flex items-center justify-center">
            <span class="text-4xl">ğŸ§</span>
          </div>
          <div class="p-4">
            <h3 id="card-3-title" class="text-lg font-semibold text-white">AirPods Max</h3>
            <p id="card-3-description" class="text-sm text-gray-400 mt-1">Space Gray, Active NC</p>
            <div class="flex justify-between items-center mt-4">
              <span id="card-3-price" class="text-xl font-bold text-green-400">$549</span>
              <button
                id="card-3-buy"
                data-testid="card-3-buy"
                data-action="buy"
                data-product="3"
                onclick="buyProduct(3)"
                class="bg-purple-600 hover:bg-purple-700 text-white text-sm py-1 px-3 rounded"
              >
                Add to Cart
              </button>
            </div>
          </div>
        </div>

        <!-- Card 4 -->
        <div
          id="card-4"
          data-testid="card-4"
          data-product-id="4"
          class="card bg-gray-900 rounded-lg overflow-hidden border border-gray-700 hover:border-purple-500 transition-colors"
        >
          <div class="h-32 bg-gradient-to-br from-pink-600 to-purple-600 flex items-center justify-center">
            <span class="text-4xl">âŒš</span>
          </div>
          <div class="p-4">
            <h3 id="card-4-title" class="text-lg font-semibold text-white">Apple Watch Ultra</h3>
            <p id="card-4-description" class="text-sm text-gray-400 mt-1">49mm, GPS + Cellular</p>
            <div class="flex justify-between items-center mt-4">
              <span id="card-4-price" class="text-xl font-bold text-green-400">$799</span>
              <button
                id="card-4-buy"
                data-testid="card-4-buy"
                data-action="buy"
                data-product="4"
                onclick="buyProduct(4)"
                class="bg-purple-600 hover:bg-purple-700 text-white text-sm py-1 px-3 rounded"
              >
                Add to Cart
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Cart Summary -->
      <div id="cart-summary" data-testid="cart-summary" class="mt-6 p-4 bg-gray-900 rounded">
        <h3 class="text-white font-medium mb-2">ğŸ›’ Cart</h3>
        <p id="cart-contents" class="text-gray-400">Cart is empty</p>
        <p id="cart-total" class="text-lg font-bold text-green-400 mt-2">Total: $0</p>
      </div>
    </section>

    <!-- Tree View Section -->
    <section id="tree-section" class="mb-12 bg-gray-800 rounded-lg p-6 border border-gray-700">
      <h2 class="text-xl font-semibold text-blue-400 mb-4">Tree View (Collapsible)</h2>

      <div id="tree-view" data-testid="tree-view" class="selector-hint text-sm">
        <div id="tree-node-root" class="tree-node">
          <button
            id="tree-toggle-root"
            data-testid="tree-toggle-root"
            onclick="toggleTreeNode('root')"
            class="text-gray-300 hover:text-white"
          >
            <span id="tree-icon-root">â–¼</span> ğŸ“ <span class="text-white">project/</span>
          </button>
          <div id="tree-children-root" class="ml-6 mt-1 space-y-1">
            <div id="tree-node-src" class="tree-node">
              <button
                id="tree-toggle-src"
                data-testid="tree-toggle-src"
                onclick="toggleTreeNode('src')"
                class="text-gray-300 hover:text-white"
              >
                <span id="tree-icon-src">â–¼</span> ğŸ“ <span class="text-white">src/</span>
              </button>
              <div id="tree-children-src" class="ml-6 mt-1 space-y-1">
                <div id="tree-node-components" class="tree-node">
                  <button
                    id="tree-toggle-components"
                    data-testid="tree-toggle-components"
                    onclick="toggleTreeNode('components')"
                    class="text-gray-300 hover:text-white"
                  >
                    <span id="tree-icon-components">â–¼</span> ğŸ“ <span class="text-white">components/</span>
                  </button>
                  <div id="tree-children-components" class="ml-6 mt-1 space-y-1">
                    <p id="tree-file-button" data-testid="tree-file-button" class="text-gray-400">ğŸ“„ Button.tsx</p>
                    <p id="tree-file-modal" data-testid="tree-file-modal" class="text-gray-400">ğŸ“„ Modal.tsx</p>
                    <p id="tree-file-form" data-testid="tree-file-form" class="text-gray-400">ğŸ“„ Form.tsx</p>
                  </div>
                </div>
                <p id="tree-file-index" data-testid="tree-file-index" class="text-gray-400">ğŸ“„ index.tsx</p>
                <p id="tree-file-app" data-testid="tree-file-app" class="text-gray-400">ğŸ“„ App.tsx</p>
              </div>
            </div>
            <div id="tree-node-public" class="tree-node">
              <button
                id="tree-toggle-public"
                data-testid="tree-toggle-public"
                onclick="toggleTreeNode('public')"
                class="text-gray-300 hover:text-white"
              >
                <span id="tree-icon-public">â–¶</span> ğŸ“ <span class="text-white">public/</span>
              </button>
              <div id="tree-children-public" class="ml-6 mt-1 space-y-1 hidden">
                <p class="text-gray-400">ğŸ“„ index.html</p>
                <p class="text-gray-400">ğŸ“„ favicon.ico</p>
              </div>
            </div>
            <p id="tree-file-package" data-testid="tree-file-package" class="text-gray-400">ğŸ“„ package.json</p>
            <p id="tree-file-readme" data-testid="tree-file-readme" class="text-gray-400">ğŸ“„ README.md</p>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Selectors Panel -->
  <aside id="selectors-panel" class="fixed bottom-4 right-4 bg-gray-800 border border-gray-600 rounded-lg shadow-xl max-w-md">
    <button
      id="toggle-selectors-panel"
      data-testid="toggle-selectors-panel"
      onclick="toggleSelectorsPanel()"
      class="w-full px-4 py-2 text-left font-semibold text-purple-400 border-b border-gray-700 flex justify-between items-center"
    >
      <span>ğŸ“‹ Data Selectors</span>
      <span id="panel-arrow">â–¼</span>
    </button>
    <div id="selectors-content" class="p-4 text-sm max-h-80 overflow-y-auto">
      <div class="selector-hint space-y-1 text-gray-300">
        <p class="font-semibold text-yellow-400">Table:</p>
        <p><span class="text-purple-400">#data-table</span> - Table container</p>
        <p><span class="text-purple-400">#sort-by-name</span> - Sort by name header</p>
        <p><span class="text-purple-400">.table-row[data-id="1"]</span> - Row by ID</p>
        <p><span class="text-purple-400">#row-action-1</span> - Edit button for row 1</p>

        <p class="font-semibold text-yellow-400 mt-4">List:</p>
        <p><span class="text-purple-400">#item-list</span> - List container</p>
        <p><span class="text-purple-400">#list-item-1</span> - First list item</p>
        <p><span class="text-purple-400">.list-item[data-id="2"]</span> - Item by ID</p>
        <p><span class="text-purple-400">#list-item-3-action</span> - Action button</p>

        <p class="font-semibold text-yellow-400 mt-4">Cards:</p>
        <p><span class="text-purple-400">#card-1</span> - First card</p>
        <p><span class="text-purple-400">.card[data-product-id="2"]</span> - By product ID</p>
        <p><span class="text-purple-400">#card-3-buy</span> - Add to cart button</p>
        <p><span class="text-purple-400">#cart-summary</span> - Cart display</p>

        <p class="font-semibold text-yellow-400 mt-4">Tree:</p>
        <p><span class="text-purple-400">#tree-toggle-src</span> - Toggle src folder</p>
        <p><span class="text-purple-400">#tree-file-app</span> - App.tsx file</p>
      </div>
    </div>
  </aside>

  <script>
    // Sample data for table
    const tableData = [
      { id: 1, name: 'Alice Johnson', email: 'alice@example.com', status: 'Active' },
      { id: 2, name: 'Bob Smith', email: 'bob@example.com', status: 'Inactive' },
      { id: 3, name: 'Carol Davis', email: 'carol@example.com', status: 'Active' },
      { id: 4, name: 'David Wilson', email: 'david@example.com', status: 'Pending' },
      { id: 5, name: 'Eva Martinez', email: 'eva@example.com', status: 'Active' },
    ];

    let sortColumn = 'id';
    let sortDirection = 'asc';

    function renderTable() {
      const tbody = document.getElementById('table-body');
      const sorted = [...tableData].sort((a, b) => {
        const aVal = a[sortColumn];
        const bVal = b[sortColumn];
        if (sortDirection === 'asc') {
          return aVal > bVal ? 1 : -1;
        } else {
          return aVal < bVal ? 1 : -1;
        }
      });

      tbody.innerHTML = sorted.map(row => `
        <tr
          id="row-${row.id}"
          data-testid="row-${row.id}"
          data-id="${row.id}"
          class="table-row border-b border-gray-700 hover:bg-gray-700"
        >
          <td class="px-4 py-3 text-gray-300">${row.id}</td>
          <td class="px-4 py-3 text-white">${row.name}</td>
          <td class="px-4 py-3 text-gray-400">${row.email}</td>
          <td class="px-4 py-3">
            <span class="px-2 py-1 rounded text-xs ${
              row.status === 'Active' ? 'bg-green-900 text-green-300' :
              row.status === 'Inactive' ? 'bg-gray-700 text-gray-400' :
              'bg-yellow-900 text-yellow-300'
            }">${row.status}</span>
          </td>
          <td class="px-4 py-3">
            <button
              id="row-action-${row.id}"
              data-testid="row-action-${row.id}"
              onclick="editRow(${row.id})"
              class="text-purple-400 hover:text-purple-300"
            >
              Edit
            </button>
          </td>
        </tr>
      `).join('');
    }

    function sortTable(column) {
      if (sortColumn === column) {
        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
      } else {
        sortColumn = column;
        sortDirection = 'asc';
      }
      document.getElementById('table-sort-info').innerHTML =
        `Sorted by: <span class="text-purple-400">${column}</span> (${sortDirection === 'asc' ? 'ascending' : 'descending'})`;
      renderTable();
    }

    function editRow(id) {
      alert(`Editing row ${id}`);
    }

    // List selection
    function selectListItem(id) {
      document.querySelectorAll('.list-item').forEach(item => {
        item.classList.remove('ring-2', 'ring-purple-500');
      });
      document.getElementById(`list-item-${id}`).classList.add('ring-2', 'ring-purple-500');
      document.getElementById('selected-list-item').innerHTML =
        `Selected: <span class="text-purple-400">Item ${id}</span>`;
    }

    function itemAction(id, action) {
      alert(`Action '${action}' on item ${id}`);
    }

    // Cart functionality
    const cart = [];

    function buyProduct(id) {
      const products = {
        1: { name: 'MacBook Pro', price: 1999 },
        2: { name: 'iPhone 15 Pro', price: 999 },
        3: { name: 'AirPods Max', price: 549 },
        4: { name: 'Apple Watch Ultra', price: 799 },
      };

      const product = products[id];
      cart.push(product);

      const total = cart.reduce((sum, p) => sum + p.price, 0);
      const items = cart.map(p => p.name).join(', ');

      document.getElementById('cart-contents').textContent = items;
      document.getElementById('cart-total').textContent = `Total: $${total.toLocaleString()}`;

      // Update button to show "Added"
      const btn = document.getElementById(`card-${id}-buy`);
      btn.textContent = 'âœ“ Added';
      btn.classList.replace('bg-purple-600', 'bg-green-600');
      setTimeout(() => {
        btn.textContent = 'Add to Cart';
        btn.classList.replace('bg-green-600', 'bg-purple-600');
      }, 1500);
    }

    // Tree view
    function toggleTreeNode(nodeId) {
      const children = document.getElementById(`tree-children-${nodeId}`);
      const icon = document.getElementById(`tree-icon-${nodeId}`);

      if (children.classList.contains('hidden')) {
        children.classList.remove('hidden');
        icon.textContent = 'â–¼';
      } else {
        children.classList.add('hidden');
        icon.textContent = 'â–¶';
      }
    }

    // Toggle selectors panel
    function toggleSelectorsPanel() {
      const content = document.getElementById('selectors-content');
      const arrow = document.getElementById('panel-arrow');
      if (content.style.display === 'none') {
        content.style.display = 'block';
        arrow.textContent = 'â–¼';
      } else {
        content.style.display = 'none';
        arrow.textContent = 'â–²';
      }
    }

    // Initialize
    renderTable();
  </script>
</body>
</html>
